"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[6928],{16928:function(e,n,t){t.r(n),t.d(n,{default:function(){return C}});var o=t(1413),a=t(93433),l=t(29439),s=t(72791),c=t(58768),r=t(61855),i=t(66818),d=t(93070),u=t(13832),m=t(31773),h=t(2556),f=t(78347),g=t(89474),Z=t(5122),p=t(35796),y=t(79286),x=t(80184),k=c.Z.confirm,S=r.Z.Search,b=(i.Z.Option,{labelCol:{span:4},wrapperCol:{span:20}}),j=r.Z.TextArea,C=function(){var e=(0,s.useState)([]),n=(0,l.Z)(e,2),t=n[0],i=n[1],C=(0,s.useState)(!1),I=(0,l.Z)(C,2),_=(I[0],I[1],(0,s.useState)([])),v=(0,l.Z)(_,2),P=(v[0],v[1],(0,s.useState)(!1)),L=(0,l.Z)(P,2),N=L[0],w=L[1],R=(0,s.useState)(""),T=(0,l.Z)(R,2),F=T[0],E=T[1],K=(0,s.useState)(!1),z=(0,l.Z)(K,2),B=z[0],A=z[1],O=(0,s.useState)([]),U=(0,l.Z)(O,2),q=U[0],D=U[1],M=(0,s.useState)([]),V=(0,l.Z)(M,2),Y=V[0],$=V[1],G=(0,s.useState)(""),H=(0,l.Z)(G,2),J=H[0],Q=H[1],W=(0,s.useState)(""),X=(0,l.Z)(W,2),ee=(X[0],X[1],(0,s.useState)(!0)),ne=(0,l.Z)(ee,2),te=(ne[0],ne[1],(0,s.useState)("")),oe=(0,l.Z)(te,2),ae=(oe[0],oe[1],(0,s.useState)([])),le=(0,l.Z)(ae,2),se=le[0],ce=le[1],re=(0,s.useState)(!0),ie=(0,l.Z)(re,2),de=(ie[0],ie[1],(0,s.useState)(!0)),ue=(0,l.Z)(de,2),me=ue[0],he=ue[1],fe=(0,s.useState)(1),ge=(0,l.Z)(fe,2),Ze=ge[0],pe=ge[1],ye=(0,s.useState)(1),xe=(0,l.Z)(ye,2),ke=xe[0],Se=xe[1],be=(0,s.useState)(""),je=(0,l.Z)(be,2),Ce=je[0],Ie=je[1],_e=(0,s.useState)(""),ve=(0,l.Z)(_e,2),Pe=ve[0],Le=ve[1],Ne=(0,s.useState)(0),we=(0,l.Z)(Ne,2),Re=we[0],Te=we[1],Fe=(0,s.useState)([]),Ee=(0,l.Z)(Fe,2),Ke=(Ee[0],Ee[1]),ze=(0,s.useState)(1),Be=(0,l.Z)(ze,2),Ae=Be[0],Oe=Be[1],Ue=d.Z.useForm(),qe=(0,l.Z)(Ue,1)[0],De=d.Z.useForm();(0,l.Z)(De,1)[0];(0,s.useEffect)((function(){Me()}),[ke]),(0,s.useEffect)((function(){(Pe||""==Pe)&&Me()}),[Pe]);var Me=function(){he(!0);var e=new URLSearchParams;e.append("number",ke),e.append("pageSize",10),e.append("roleName",Pe),Z.Z.post("system_management/system_user/role/allRoleListByNamePageable",e).then((function(e){console.log(e),200==e.data.code&&(i(e.data.data.content),he(!1),Ie(e.data.data.totalElements))})).catch((function(e){console.log(e)}))},Ve=function(e){console.log(e);A(!0),E(e.roleId),pe(0),Z.Z.post("system_management/system_user/menu/menuTree").then((function(n){if(200==n.data.code){console.log(n);var t=n.data.data;console.log(t),Z.Z.post("system_management/system_user/menu/menuListByRoleId?roleId="+e.roleId).then((function(e){200==e.data.code&&(console.log(e),$(e.data.data))})),Z.Z.post("system_management/system_user/menu/menuListByRoleId?roleId="+e.roleId).then((function(e){if(console.log(e),200==e.data.code){for(var n=e.data.data,o=0;o<t.length;o++)if(t[o].children){console.log(t[o].children);for(var l=0;l<n.length;l++)n[l]==t[o].key&&n.splice(l,1);for(var s=t[o].children,c=0;c<s.length;c++)if(s[c].children){console.log(s[c],"-----");for(l=0;l<n.length;l++)n[l]==s[c].key&&(console.log(s[c]),s[c].children&&(console.log(s[c].children),n.splice(l,1)));var r=s[c].children;if(console.log(r,"key"),r)for(var i=0;i<r.length;i++){console.log(r[i]);for(var d=0;d<n.length;d++)n[d]==r[i].key&&r[i].children&&n.splice(d,1)}}}else for(l=0;l<n.length;l++)n[l]==t[o].key&&(console.log(t[o].key),console.log(n[l]),console.log(n));Q((0,a.Z)(e.data.data)),D((0,a.Z)(t)),ce((0,a.Z)(e.data.data))}})).catch((function(e){console.log(e)}))}})).catch((function(e){console.log(e)}))},Ye=[{title:"\u5e8f\u53f7",dataIndex:"orderNum",key:"orderNum",render:function(e,n,t){return 10*(ke-1)+t+1}},{title:"\u89d2\u8272\u540d\u79f0",dataIndex:"roleName",key:"roleName"},{title:"\u5907\u6ce8",dataIndex:"roleLabel",key:"roleLabel"},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"createdTime",key:"createdTime"},{title:"\u64cd\u4f5c",dataIndex:"action",key:"action",render:function(e,n,t){return"Y"==n.configType?(0,x.jsxs)(m.Z,{size:"middle",children:[(0,x.jsx)("a",{onClick:function(){return Ve(n)},children:"\u5206\u914d\u6743\u9650 "}),(0,x.jsx)("a",{style:{display:"none"},disabled:!0,children:"\u7f16\u8f91 "}),(0,x.jsx)("a",{style:{display:"none"},disabled:!0,children:"\u5220\u9664"})]}):(0,x.jsxs)(m.Z,{size:"middle",children:[(0,x.jsx)("a",{onClick:function(){return Ve(n)},children:"\u5206\u914d\u6743\u9650 "}),(0,x.jsx)("a",{onClick:function(){return e=n,w(!0),E(e.roleId),Te(1),void qe.setFieldsValue({sname:e.roleName,roleLabel:e.roleLabel});var e},children:"\u7f16\u8f91 "}),(0,x.jsx)("a",{onClick:function(){return function(e){console.log(e);var n=e.roleId;k({title:"\u786e\u5b9a\u8981\u5220\u9664\u5417?",icon:(0,x.jsx)(p.Z,{}),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",cancelButtonProps:{className:"newbutton",style:{background:"none"}},onOk:function(){console.log("OK"),Z.Z.post("system_management/system_user/role/deleteRoleById?roleId="+n).then((function(e){console.log(e),200==e.data.code?(u.ZP.success("\u5220\u9664\u6210\u529f"),Me()):u.ZP.warning(e.data.msg)}))},onCancel:function(){console.log("Cancel")}})}(n)},children:"\u5220\u9664"})]})}}],$e=function(){A(!1)};return(0,x.jsxs)("div",{className:"role",children:[(0,x.jsxs)("div",{className:"roleheader",children:[(0,x.jsxs)(h.ZP,{type:"primary",onClick:function(){w(!0),Te(0)},children:[(0,x.jsx)(y.Z,{}),"\u65b0\u5efa\u89d2\u8272"]}),(0,x.jsx)(S,{placeholder:"\u540d\u79f0",onSearch:function(e){console.log(e),Se(1),Oe(1),Le(e)},style:{width:200,float:"right"}})]}),(0,x.jsx)(f.Z,{dataSource:t,columns:Ye,loading:me,pagination:{total:Ce,defaultCurrent:1,defaultPageSize:10,showSizeChanger:!1,current:Ae},onChange:function(e){console.log(e),Se(e.current),Oe(e.current)}}),(0,x.jsx)(c.Z,{title:0==Re?"\u65b0\u589e":"\u7f16\u8f91",footer:null,maskClosable:!1,visible:N,onCancel:function(){qe.resetFields(),w(!1)},children:(0,x.jsxs)(d.Z,(0,o.Z)((0,o.Z)({form:qe},b),{},{onFinish:function(e){if(console.log(e,"-------"),0==Re)Z.Z.post("system_management/system_user/role/addRole",{roleId:"",roleKey:"",roleLabel:e.roleLabel?e.roleLabel:"",roleName:e.sname}).then((function(e){console.log(e),200==e.data.code?(u.ZP.success("\u6dfb\u52a0\u6210\u529f"),Me(),qe.resetFields(),w(!1)):u.ZP.warning(e.data.msg)})).catch((function(e){console.log(e)}));else if(1==Re){var n=new URLSearchParams;n.append("roleId",F),n.append("roleName",e.sname),n.append("roleLabel",e.roleLabel),Z.Z.post("system_management/system_user/role/updateRoleName",n).then((function(e){200==e.data.code?(u.ZP.success("\u7f16\u8f91\u6210\u529f"),w(!1),Me(),qe.resetFields()):u.ZP.warning(e.data.msg)})).catch((function(e){console.log(e)}))}},children:[(0,x.jsx)(d.Z.Item,{name:"sname",label:"\u89d2\u8272\u540d\u79f0",rules:[{required:!0,pattern:new RegExp(/^[a-zA-Z0-9_\u4e00-\u9fa5]{0,20}$/),message:"\u8bf7\u586b\u5199\u6b63\u786e\u7684\u540d\u79f0\uff0820\u4e2a\u4ee5\u5185\u7684\u6c49\u5b57\u3001\u5b57\u6bcd\u6216\u6570\u5b57\u3001_\uff09"}],children:(0,x.jsx)(r.Z,{maxLength:50})}),(0,x.jsx)(d.Z.Item,{name:"roleLabel",label:"\u5907\u6ce8",children:(0,x.jsx)(j,{maxLength:50})}),(0,x.jsxs)(d.Z.Item,{wrapperCol:{offset:14,span:10},style:{textAlign:"right"},children:[(0,x.jsx)(h.ZP,{ghost:!0,onClick:function(){qe.resetFields(),w(!1)},style:{marginRight:10},children:"\u53d6\u6d88"}),(0,x.jsx)(h.ZP,{type:"primary",htmlType:"submit",children:"\u786e\u5b9a"})]})]}))}),(0,x.jsx)(c.Z,{title:1==Ze?"\u67e5\u770b":"\u5206\u914d\u6743\u9650",visible:B,className:"menu_managementForm",onCancel:$e,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",footer:[(0,x.jsx)(h.ZP,{ghost:!0,onClick:$e,children:"\u53d6\u6d88"}),(0,x.jsx)(h.ZP,{type:"primary",onClick:function(){Z.Z.post("system_management/system_user/role/updateRoleMenuIds",{menuIds:Y,roleId:F}).then((function(e){console.log(e),200==e.data.code&&(u.ZP.success("\u6210\u529f"),Q([]),D([]),A(!1))})).catch((function(e){console.log(e)}))},children:"\u786e\u5b9a"},"submit")],children:q.length&&(0,x.jsx)(g.Z,{checkable:!0,multiple:!0,autoExpandParent:!0,defaultExpandAll:!0,defaultCheckedKeys:J,defaultExpandedKeys:J,checkedKeys:se,onCheck:function(e,n){console.log(e),console.log(n);var t=[];e.map((function(e){t.push(e)})),console.log(t),n.halfCheckedKeys&&n.halfCheckedKeys.length>0&&n.halfCheckedKeys.map((function(e){t.push(e)})),ce(e),$(t)},treeData:q,onExpand:function(e){Ke(e)},disabled:1==Ze})})]})}}}]);
//# sourceMappingURL=6928.9798a09a.chunk.js.map
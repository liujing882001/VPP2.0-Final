"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[4349],{34349:function(e,t,n){n.r(t),n.d(t,{default:function(){return I}});var o=n(29439),l=n(72791),a=n(66818),c=n(58768),d=n(93070),s=n(13832),i=n(31773),u=n(2556),r=n(78347),m=n(61855),h=n(35796),f=n(5122),Z=n(80184),p=a.Z.Option,g=c.Z.confirm,I=function(){var e=(0,l.useState)(!1),t=(0,o.Z)(e,2),n=t[0],I=t[1],v=(0,l.useState)([]),x=(0,o.Z)(v,2),y=x[0],j=x[1],N=(0,l.useState)(""),b=(0,o.Z)(N,2),M=b[0],S=b[1],C=(0,l.useState)(""),F=(0,o.Z)(C,2),P=F[0],k=F[1],w=(0,l.useState)([]),V=(0,o.Z)(w,2),T=V[0],L=V[1],_=(0,l.useState)(0),z=(0,o.Z)(_,2),O=(z[0],z[1],(0,l.useState)(!1)),A=(0,o.Z)(O,2),D=A[0],E=A[1],B=(0,l.useState)([]),K=(0,o.Z)(B,2),q=K[0],G=K[1],H=(0,l.useState)(""),J=(0,o.Z)(H,2),Q=J[0],R=J[1],U=(0,l.useState)([]),W=(0,o.Z)(U,2),X=W[0],Y=W[1],$=(0,l.useState)([]),ee=(0,o.Z)($,2),te=ee[0],ne=ee[1],oe=(0,l.useState)(""),le=(0,o.Z)(oe,2),ae=le[0],ce=le[1],de=(0,l.useState)(""),se=(0,o.Z)(de,2),ie=se[0],ue=se[1],re=(0,l.useState)(""),me=(0,o.Z)(re,2),he=me[0],fe=(me[1],(0,l.useState)("")),Ze=(0,o.Z)(fe,2),pe=Ze[0],ge=Ze[1],Ie=(0,l.useState)(""),ve=(0,o.Z)(Ie,2),xe=ve[0],ye=ve[1],je=(0,l.useState)(""),Ne=(0,o.Z)(je,2),be=Ne[0],Me=Ne[1],Se=(0,l.useState)(""),Ce=(0,o.Z)(Se,2),Fe=(Ce[0],Ce[1]),Pe=(0,l.useState)(""),ke=(0,o.Z)(Pe,2),we=ke[0],Ve=ke[1],Te=(0,l.useState)(""),Le=(0,o.Z)(Te,2),_e=Le[0],ze=Le[1],Oe=(0,l.useState)(""),Ae=(0,o.Z)(Oe,2),De=Ae[0],Ee=Ae[1],Be=d.Z.useForm(),Ke=(0,o.Z)(Be,1)[0];(0,l.useEffect)((function(){qe()}),[]);(0,l.useEffect)((function(){""!==we&&(Ge(),He())}),[we]);var qe=function(){f.Z.post("system_management/node_model/nodeNameList").then((function(e){console.log(e),200==e.data.code?(j(e.data.data),S(e.data.data.length>0?e.data.data[0].id:""),Ve(e.data.data.length>0?e.data.data[0].id:"")):c.Z.error({title:"\u9519\u8bef"})})).catch((function(e){console.log(e)}))},Ge=function(){I(!0),f.Z.post("carbon/collectionModel/getCollectionModelList?nodeId="+M+"&scopeType="+P).then((function(e){console.log(e),200==e.data.code&&(L(e.data.data.content),I(!1))})).catch((function(e){console.log(e)}))},He=function(){f.Z.post("carbon/collectionModel/nodeSystemList?nodeId="+M).then((function(e){console.log(e),200==e.data.code&&G(e.data.data)})).catch((function(e){console.log(e)}))},Je=function(e){console.log(e),f.Z.post("carbon/collectionModel/getAllDevice?nodeId="+M+"&systemId="+e).then((function(t){if(console.log(t),200==t.data.code){var n=t.data.data;console.log(n,"deviceList");for(var o=0;o<n.length;o++)n[o].systemId==e&&ne(n[o].pointViewList);Y(t.data.data)}})).catch((function(e){console.log(e)}))},Qe=[{title:"\u7c7b\u578b",dataIndex:"emissionFactorName",key:"emissionFactorName"},{title:"\u91c7\u96c6\u65b9\u5f0f",dataIndex:"collectMode",key:"collectMode",render:function(e,t){return(0,Z.jsx)("span",{children:0==e?"\u81ea\u52a8":1==e?"\u624b\u52a8":"-"})}},{title:"\u7cfb\u7edf",dataIndex:"systemName",key:"systemName",render:function(e,t,n,o){return console.log(e),null==e||void 0==e||""==e?"-":e}},{title:"\u8bbe\u5907",dataIndex:"deviceName",key:"deviceName",render:function(e,t,n,o){return null==e||void 0==e||""==e?"-":e}},{title:"\u6570\u636e\u70b9",dataIndex:"dataPointName",key:"dataPointName",render:function(e,t,n,o){return null==e||void 0==e||""==e?"-":e}},{title:"\u64cd\u4f5c",dataIndex:"dates",key:"dates",render:function(e,t,n,o){return(0,Z.jsxs)(i.Z,{size:"middle",children:[(0,Z.jsx)("a",{onClick:function(){return e=t,console.log(e),Je(e.systemId),void(0==e.collectMode?(E(!0),ue(e.collectionModelId),ge(e.emissionFactorNum),Me(e.scopeType),ce(e.dataPointName),ye(e.collectMode),Fe(0),Ke.setFieldsValue({emissionFactorName:e.emissionFactorName,collectMode:e.collectMode,systemId:e.systemId,deviceId:e.deviceId,dataPointId:e.dataPointId})):(1==e.collectMode||null===e.collectMode)&&(E(!0),ue(e.collectionModelId),ge(e.emissionFactorNum),Me(e.scopeType),ce(null),ye(e.collectMode),Fe(0),Ke.setFieldsValue({emissionFactorName:e.emissionFactorName,collectMode:e.collectMode,systemId:null,deviceId:null,dataPointId:null})));var e},children:"\u7f16\u8f91"}),(0,Z.jsx)("a",{onClick:function(){return e=t,console.log(e),void g({title:"\u63d0\u793a",icon:(0,Z.jsx)(h.Z,{}),content:"\u786e\u5b9a\u8981\u5220\u9664\u5417",cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",cancelButtonProps:{className:"newbutton",style:{background:"none"}},onOk:function(){console.log("OK"),f.Z.post("carbon/collectionModel/removeCollectionModel?collectionModelId="+e.collectionModelId).then((function(e){console.log(e),200==e.data.code?(s.ZP.success(e.data.msg),Ge()):s.ZP.success(e.data.msg)})).catch((function(e){console.log(e)}))},onCancel:function(){console.log("Cancel")}});var e},children:"\u5220\u9664"})]})}}];return(0,Z.jsxs)("div",{className:"allcontent1",children:[(0,Z.jsxs)("div",{className:"header",children:["\u8282\u70b9\uff1a",(0,Z.jsx)(a.Z,{placeholder:"\u8282\u70b9",style:{width:217},onChange:function(e){console.log(e),S(e)},defaultValue:we,children:y&&y.map((function(e){return(0,Z.jsx)(p,{value:e.id,children:e.nodeName})}))},we),"\u8303\u56f4\uff1a",(0,Z.jsx)(a.Z,{defaultValue:"",style:{width:217},onChange:function(e){console.log(e),k(e),Me(e)},options:[{value:"",label:"\u5168\u90e8"},{value:"1",label:"\u8303\u56f4\u4e00"},{value:"2",label:"\u8303\u56f4\u4e8c"},{value:"3",label:"\u8303\u56f4\u4e09"}]}),(0,Z.jsx)(u.ZP,{type:"primary",onClick:function(){Ge()},children:"\u67e5\u8be2"})]}),(0,Z.jsx)("div",{className:"mechanism",children:(0,Z.jsx)(r.Z,{dataSource:T,columns:Qe,loading:n,pagination:{defaultCurrent:1,defaultPageSize:10,showSizeChanger:!1}})}),(0,Z.jsx)(c.Z,{title:"\u7f16\u8f91",visible:D,onCancel:function(){console.log("Clicked cancel button"),E(!1),Ke.resetFields()},footer:null,children:(0,Z.jsxs)(d.Z,{name:"basic",labelCol:{span:6},wrapperCol:{span:16},initialValues:{remember:!0},onFinish:function(e){console.log("Success:",e),f.Z.post("carbon/collectionModel/editCollectionModel",{collectMode:e.collectMode,collectionModelId:ie,createdTime:he,dataPointId:e.dataPointId,dataPointName:ae,deviceId:e.deviceId,deviceName:De,emissionFactorName:e.emissionFactorName,emissionFactorNum:pe,nodeId:M,scopeType:be,sstatus:"",systemId:e.systemId,systemName:_e,updateTime:""}).then((function(e){console.log(e),200==e.data.code&&(E(!1),Ke.resetFields(),s.ZP.success("\u7f16\u8f91\u6210\u529f"),Ge())})).catch((function(e){console.log(e)}))},onFinishFailed:function(e){console.log("Failed:",e)},autoComplete:"off",form:Ke,children:[(0,Z.jsx)(d.Z.Item,{label:"\u7c7b\u578b",name:"emissionFactorName",children:(0,Z.jsx)(m.Z,{disabled:!0})}),(0,Z.jsx)(d.Z.Item,{label:"\u91c7\u96c6\u65b9\u5f0f",name:"collectMode",children:(0,Z.jsxs)(a.Z,{placeholder:"\u91c7\u96c6\u65b9\u5f0f",onChange:function(e){console.log(e),1==e&&(Ke.setFieldsValue({systemId:null,deviceId:null,dataPointId:null}),ce(null),Ee(null),ze(null)),ye(e)},children:[(0,Z.jsx)(p,{value:0,children:"\u81ea\u52a8"}),(0,Z.jsx)(p,{value:1,children:"\u624b\u52a8"})]})}),(0,Z.jsx)(d.Z.Item,{label:"\u7cfb\u7edf",name:"systemId",children:(0,Z.jsx)(a.Z,{placeholder:"\u7cfb\u7edf",onChange:function(e,t){R(e),ze(t.children),f.Z.post("carbon/collectionModel/getAllDevice?nodeId="+M+"&systemId="+Q).then((function(e){console.log(e),200==e.data.code&&Y(e.data.data)})).catch((function(e){console.log(e)})),Ke.setFieldsValue({deviceId:null,dataPointId:null})},disabled:1==xe,children:q.length&&q.map((function(e){return(0,Z.jsx)(p,{value:e.id,children:e.systemName})}))})}),(0,Z.jsx)(d.Z.Item,{label:"\u8bbe\u5907",name:"deviceId",children:(0,Z.jsx)(a.Z,{placeholder:"\u8bbe\u5907",onChange:function(e,t){console.log(e,t),Ee(t.children),Ke.setFieldsValue({dataPointId:null});for(var n=0;n<X.length;n++)X[n].deviceId==e&&ne(X[n].pointViewList)},disabled:1==xe,children:X.length&&X.map((function(e){return(0,Z.jsx)(p,{value:e.deviceId,children:e.deviceName})}))})}),(0,Z.jsx)(d.Z.Item,{label:"\u6570\u636e\u70b9",name:"dataPointId",children:(0,Z.jsx)(a.Z,{placeholder:"\u6570\u636e\u70b9",onChange:function(e,t){ce(t.children)},disabled:1==xe,children:te.length&&te.map((function(e){return(0,Z.jsx)(p,{value:e.pointId,children:e.pointName})}))})}),(0,Z.jsxs)(d.Z.Item,{wrapperCol:{offset:8,span:16},children:[(0,Z.jsx)(u.ZP,{type:"primary",htmlType:"submit",children:"\u786e\u5b9a"}),(0,Z.jsx)(u.ZP,{onClick:function(){E(!1)},style:{marginLeft:"10px"},children:"\u53d6\u6d88"})]})]})})]})}}}]);
//# sourceMappingURL=4349.5a6265f3.chunk.js.map